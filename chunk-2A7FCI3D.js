import{a as vt}from"./chunk-EMBPV7JI.js";import{a as ue}from"./chunk-GRDDIUM7.js";import{a as le,n as de,o as fe}from"./chunk-DL7DH7M3.js";import{A as V,B as ce,a as B,b as qt,c as re,d as E,g as N,h as z,i as $,j as ie,k as ne,l as j,m as X,o as J,p as F,q as bt,r as oe,s as ae,u as he}from"./chunk-AOUDBIVJ.js";import{a as G,b as dt,c as se,d as ns,e as os}from"./chunk-C6Q5SG76.js";var ve=ns((ii,qe)=>{"use strict";qe.exports=Ms;var Ft={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},Ps=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function Ms(o){var t=[];return o.replace(Ps,function(s,e,i){var r=e.toLowerCase();for(i=ks(i),r=="m"&&i.length>2&&(t.push([e].concat(i.splice(0,2))),r="l",e=e=="m"?"l":"L");;){if(i.length==Ft[r])return i.unshift(e),t.push(i);if(i.length<Ft[r])throw new Error("malformed path data");t.push([e].concat(i.splice(0,Ft[r])))}}),t}var Ss=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function ks(o){var t=o.match(Ss);return t?t.map(Number):[]}});function pe(o,t,s,e,i,r){let n=o-s,a=t-e,h=i-s,l=r-e,c=n*h+a*l,u=h*h+l*l,f=-1;u!==0&&(f=c/u);let d,p;f<0?(d=s,p=e):f>1?(d=i,p=r):(d=s+f*h,p=e+f*l);let y=o-d,g=t-p;return y*y+g*g}var _t=class o{constructor(t=0,s=0,e=0){this.type="circle",this.x=t,this.y=s,this.radius=e}clone(){return new o(this.x,this.y,this.radius)}contains(t,s){if(this.radius<=0)return!1;let e=this.radius*this.radius,i=this.x-t,r=this.y-s;return i*=i,r*=r,i+r<=e}strokeContains(t,s,e,i=.5){if(this.radius===0)return!1;let r=this.x-t,n=this.y-s,a=this.radius,h=(1-i)*e,l=Math.sqrt(r*r+n*n);return l<=a+h&&l>a-(e-h)}getBounds(t){return t||(t=new F),t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=this.radius*2,t.height=this.radius*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}};var Pt=class o{constructor(t=0,s=0,e=0,i=0){this.type="ellipse",this.x=t,this.y=s,this.halfWidth=e,this.halfHeight=i}clone(){return new o(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,s){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let e=(t-this.x)/this.halfWidth,i=(s-this.y)/this.halfHeight;return e*=e,i*=i,e+i<=1}strokeContains(t,s,e,i=.5){let{halfWidth:r,halfHeight:n}=this;if(r<=0||n<=0)return!1;let a=e*(1-i),h=e-a,l=r-h,c=n-h,u=r+a,f=n+a,d=t-this.x,p=s-this.y,y=d*d/(l*l)+p*p/(c*c),g=d*d/(u*u)+p*p/(f*f);return y>1&&g<=1}getBounds(t){return t||(t=new F),t.x=this.x-this.halfWidth,t.y=this.y-this.halfHeight,t.width=this.halfWidth*2,t.height=this.halfHeight*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}};var as,hs,rt=class o{constructor(...t){this.type="polygon";let s=Array.isArray(t[0])?t[0]:t;if(typeof s[0]!="number"){let e=[];for(let i=0,r=s.length;i<r;i++)e.push(s[i].x,s[i].y);s=e}this.points=s,this.closePath=!0}isClockwise(){let t=0,s=this.points,e=s.length;for(let i=0;i<e;i+=2){let r=s[i],n=s[i+1],a=s[(i+2)%e],h=s[(i+3)%e];t+=(a-r)*(h+n)}return t<0}containsPolygon(t){let s=this.getBounds(as),e=t.getBounds(hs);if(!s.containsRect(e))return!1;let i=t.points;for(let r=0;r<i.length;r+=2){let n=i[r],a=i[r+1];if(!this.contains(n,a))return!1}return!0}clone(){let t=this.points.slice(),s=new o(t);return s.closePath=this.closePath,s}contains(t,s){let e=!1,i=this.points.length/2;for(let r=0,n=i-1;r<i;n=r++){let a=this.points[r*2],h=this.points[r*2+1],l=this.points[n*2],c=this.points[n*2+1];h>s!=c>s&&t<(l-a)*((s-h)/(c-h))+a&&(e=!e)}return e}strokeContains(t,s,e,i=.5){let r=e*e,n=r*(1-i),a=r-n,{points:h}=this,l=h.length-(this.closePath?0:2);for(let c=0;c<l;c+=2){let u=h[c],f=h[c+1],d=h[(c+2)%h.length],p=h[(c+3)%h.length],y=pe(t,s,u,f,d,p),g=Math.sign((d-u)*(s-f)-(p-f)*(t-u));if(y<=(g<0?a:n))return!0}return!1}getBounds(t){t||(t=new F);let s=this.points,e=1/0,i=-1/0,r=1/0,n=-1/0;for(let a=0,h=s.length;a<h;a+=2){let l=s[a],c=s[a+1];e=l<e?l:e,i=l>i?l:i,r=c<r?c:r,n=c>n?c:n}return t.x=e,t.width=i-e,t.y=r,t.height=n-r,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,s)=>`${t}, ${s}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return j("8.11.0","Polygon.lastX is deprecated, please use Polygon.lastX instead."),this.points[this.points.length-2]}get y(){return j("8.11.0","Polygon.y is deprecated, please use Polygon.lastY instead."),this.points[this.points.length-1]}get startX(){return this.points[0]}get startY(){return this.points[1]}};var Mt=(o,t,s,e,i,r,n)=>{let a=o-s,h=t-e,l=Math.sqrt(a*a+h*h);return l>=i-r&&l<=i+n},St=class o{constructor(t=0,s=0,e=0,i=0,r=20){this.type="roundedRectangle",this.x=t,this.y=s,this.width=e,this.height=i,this.radius=r}getBounds(t){return t||(t=new F),t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new o(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,s){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&s>=this.y&&s<=this.y+this.height){let e=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(s>=this.y+e&&s<=this.y+this.height-e||t>=this.x+e&&t<=this.x+this.width-e)return!0;let i=t-(this.x+e),r=s-(this.y+e),n=e*e;if(i*i+r*r<=n||(i=t-(this.x+this.width-e),i*i+r*r<=n)||(r=s-(this.y+this.height-e),i*i+r*r<=n)||(i=t-(this.x+e),i*i+r*r<=n))return!0}return!1}strokeContains(t,s,e,i=.5){let{x:r,y:n,width:a,height:h,radius:l}=this,c=e*(1-i),u=e-c,f=r+l,d=n+l,p=a-l*2,y=h-l*2,g=r+a,x=n+h;return(t>=r-c&&t<=r+u||t>=g-u&&t<=g+c)&&s>=d&&s<=d+y||(s>=n-c&&s<=n+u||s>=x-u&&s<=x+c)&&t>=f&&t<=f+p?!0:t<f&&s<d&&Mt(t,s,f,d,l,u,c)||t>g-l&&s<d&&Mt(t,s,g-l,d,l,u,c)||t>g-l&&s>x-l&&Mt(t,s,g-l,x-l,l,u,c)||t<f&&s>x-l&&Mt(t,s,f,x-l,l,u,c)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}};function me(o){let t=o.length;if(t<6)return 1;let s=0;for(let e=0,i=o[t-2],r=o[t-1];e<t;e+=2){let n=o[e],a=o[e+1];s+=(n-i)*(a+r),i=n,r=a}return s<0?-1:1}function ye(o,t,s,e,i,r,n,a){let h=o-s*i,l=t-e*i,c=o+s*r,u=t+e*r,f,d;n?(f=e,d=-s):(f=-e,d=s);let p=h+f,y=l+d,g=c+f,x=u+d;return a.push(p,y),a.push(g,x),2}function tt(o,t,s,e,i,r,n,a){let h=s-o,l=e-t,c=Math.atan2(h,l),u=Math.atan2(i-o,r-t);a&&c<u?c+=Math.PI*2:!a&&c>u&&(u+=Math.PI*2);let f=c,d=u-c,p=Math.abs(d),y=Math.sqrt(h*h+l*l),g=(15*p*Math.sqrt(y)/Math.PI>>0)+1,x=d/g;if(f+=x,a){n.push(o,t),n.push(s,e);for(let m=1,T=f;m<g;m++,T+=x)n.push(o,t),n.push(o+Math.sin(T)*y,t+Math.cos(T)*y);n.push(o,t),n.push(i,r)}else{n.push(s,e),n.push(o,t);for(let m=1,T=f;m<g;m++,T+=x)n.push(o+Math.sin(T)*y,t+Math.cos(T)*y),n.push(o,t);n.push(i,r),n.push(o,t)}return g*2}function ge(o,t,s,e,i,r){let n=1e-4;if(o.length===0)return;let a=t,h=a.alignment;if(t.alignment!==.5){let D=me(o);s&&(D*=-1),h=(h-.5)*D+.5}let l=new N(o[0],o[1]),c=new N(o[o.length-2],o[o.length-1]),u=e,f=Math.abs(l.x-c.x)<n&&Math.abs(l.y-c.y)<n;if(u){o=o.slice(),f&&(o.pop(),o.pop(),c.set(o[o.length-2],o[o.length-1]));let D=(l.x+c.x)*.5,U=(c.y+l.y)*.5;o.unshift(D,U),o.push(D,U)}let d=i,p=o.length/2,y=o.length,g=d.length/2,x=a.width/2,m=x*x,T=a.miterLimit*a.miterLimit,P=o[0],C=o[1],b=o[2],_=o[3],I=0,A=0,S=-(C-_),M=P-b,R=0,q=0,v=Math.sqrt(S*S+M*M);S/=v,M/=v,S*=x,M*=x;let st=h,k=(1-st)*2,w=st*2;u||(a.cap==="round"?y+=tt(P-S*(k-w)*.5,C-M*(k-w)*.5,P-S*k,C-M*k,P+S*w,C+M*w,d,!0)+2:a.cap==="square"&&(y+=ye(P,C,S,M,k,w,!0,d))),d.push(P-S*k,C-M*k),d.push(P+S*w,C+M*w);for(let D=1;D<p-1;++D){P=o[(D-1)*2],C=o[(D-1)*2+1],b=o[D*2],_=o[D*2+1],I=o[(D+1)*2],A=o[(D+1)*2+1],S=-(C-_),M=P-b,v=Math.sqrt(S*S+M*M),S/=v,M/=v,S*=x,M*=x,R=-(_-A),q=b-I,v=Math.sqrt(R*R+q*q),R/=v,q/=v,R*=x,q*=x;let U=b-P,ht=C-_,ct=b-I,lt=A-_,Zt=U*ct+ht*lt,yt=ht*ct-lt*U,ut=yt<0;if(Math.abs(yt)<.001*Math.abs(Zt)){d.push(b-S*k,_-M*k),d.push(b+S*w,_+M*w),Zt>=0&&(a.join==="round"?y+=tt(b,_,b-S*k,_-M*k,b-R*k,_-q*k,d,!1)+4:y+=2,d.push(b-R*w,_-q*w),d.push(b+R*k,_+q*k));continue}let Jt=(-S+P)*(-M+_)-(-S+b)*(-M+C),te=(-R+I)*(-q+_)-(-R+b)*(-q+A),gt=(U*te-ct*Jt)/yt,xt=(lt*Jt-ht*te)/yt,Gt=(gt-b)*(gt-b)+(xt-_)*(xt-_),Q=b+(gt-b)*k,O=_+(xt-_)*k,K=b-(gt-b)*w,Z=_-(xt-_)*w,rs=Math.min(U*U+ht*ht,ct*ct+lt*lt),ee=ut?k:w,is=rs+ee*ee*m;Gt<=is?a.join==="bevel"||Gt/m>T?(ut?(d.push(Q,O),d.push(b+S*w,_+M*w),d.push(Q,O),d.push(b+R*w,_+q*w)):(d.push(b-S*k,_-M*k),d.push(K,Z),d.push(b-R*k,_-q*k),d.push(K,Z)),y+=2):a.join==="round"?ut?(d.push(Q,O),d.push(b+S*w,_+M*w),y+=tt(b,_,b+S*w,_+M*w,b+R*w,_+q*w,d,!0)+4,d.push(Q,O),d.push(b+R*w,_+q*w)):(d.push(b-S*k,_-M*k),d.push(K,Z),y+=tt(b,_,b-S*k,_-M*k,b-R*k,_-q*k,d,!1)+4,d.push(b-R*k,_-q*k),d.push(K,Z)):(d.push(Q,O),d.push(K,Z)):(d.push(b-S*k,_-M*k),d.push(b+S*w,_+M*w),a.join==="round"?ut?y+=tt(b,_,b+S*w,_+M*w,b+R*w,_+q*w,d,!0)+2:y+=tt(b,_,b-S*k,_-M*k,b-R*k,_-q*k,d,!1)+2:a.join==="miter"&&Gt/m<=T&&(ut?(d.push(K,Z),d.push(K,Z)):(d.push(Q,O),d.push(Q,O)),y+=2),d.push(b-R*k,_-q*k),d.push(b+R*w,_+q*w),y+=2)}P=o[(p-2)*2],C=o[(p-2)*2+1],b=o[(p-1)*2],_=o[(p-1)*2+1],S=-(C-_),M=P-b,v=Math.sqrt(S*S+M*M),S/=v,M/=v,S*=x,M*=x,d.push(b-S*k,_-M*k),d.push(b+S*w,_+M*w),u||(a.cap==="round"?y+=tt(b-S*(k-w)*.5,_-M*(k-w)*.5,b-S*k,_-M*k,b+S*w,_+M*w,d,!1)+2:a.cap==="square"&&(y+=ye(b,_,S,M,k,w,!1,d)));let at=1e-4*1e-4;for(let D=g;D<y+g-2;++D)P=d[D*2],C=d[D*2+1],b=d[(D+1)*2],_=d[(D+1)*2+1],I=d[(D+2)*2],A=d[(D+2)*2+1],!(Math.abs(P*(_-A)+b*(A-C)+I*(C-_))<at)&&r.push(D,D+1,D+2)}var xe=[{offset:0,color:"white"},{offset:1,color:"black"}],us=(()=>{let o=class Lt{constructor(...s){this.uid=$("fillGradient"),this._tick=0,this.type="linear",this.colorStops=[];let e=ds(s),i=e.type==="radial"?Lt.defaultRadialOptions:Lt.defaultLinearOptions;e=G(G({},i),he(e)),this._textureSize=e.textureSize,this._wrapMode=e.wrapMode,e.type==="radial"?(this.center=e.center,this.outerCenter=e.outerCenter??this.center,this.innerRadius=e.innerRadius,this.outerRadius=e.outerRadius,this.scale=e.scale,this.rotation=e.rotation):(this.start=e.start,this.end=e.end),this.textureSpace=e.textureSpace,this.type=e.type,e.colorStops.forEach(r=>{this.addColorStop(r.offset,r.color)})}addColorStop(s,e){return this.colorStops.push({offset:s,color:E.shared.setValue(e).toHexa()}),this}buildLinearGradient(){if(this.texture)return;let{x:s,y:e}=this.start,{x:i,y:r}=this.end,n=i-s,a=r-e,h=n<0||a<0;if(this._wrapMode==="clamp-to-edge"){if(n<0){let x=s;s=i,i=x,n*=-1}if(a<0){let x=e;e=r,r=x,a*=-1}}let l=this.colorStops.length?this.colorStops:xe,c=this._textureSize,{canvas:u,context:f}=_e(c,1),d=h?f.createLinearGradient(this._textureSize,0,0,0):f.createLinearGradient(0,0,this._textureSize,0);be(d,l),f.fillStyle=d,f.fillRect(0,0,c,1),this.texture=new V({source:new vt({resource:u,addressMode:this._wrapMode})});let p=Math.sqrt(n*n+a*a),y=Math.atan2(a,n),g=new z;g.scale(p/c,1),g.rotate(y),g.translate(s,e),this.textureSpace==="local"&&g.scale(c,c),this.transform=g}buildGradient(){this.texture||this._tick++,this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;let s=this.colorStops.length?this.colorStops:xe,e=this._textureSize,{canvas:i,context:r}=_e(e,e),{x:n,y:a}=this.center,{x:h,y:l}=this.outerCenter,c=this.innerRadius,u=this.outerRadius,f=h-u,d=l-u,p=e/(u*2),y=(n-f)*p,g=(a-d)*p,x=r.createRadialGradient(y,g,c*p,(h-f)*p,(l-d)*p,u*p);be(x,s),r.fillStyle=s[s.length-1].color,r.fillRect(0,0,e,e),r.fillStyle=x,r.translate(y,g),r.rotate(this.rotation),r.scale(1,this.scale),r.translate(-y,-g),r.fillRect(0,0,e,e),this.texture=new V({source:new vt({resource:i,addressMode:this._wrapMode})});let m=new z;m.scale(1/p,1/p),m.translate(f,d),this.textureSpace==="local"&&m.scale(e,e),this.transform=m}destroy(){this.texture?.destroy(!0),this.texture=null,this.transform=null,this.colorStops=[],this.start=null,this.end=null,this.center=null,this.outerCenter=null}get styleKey(){return`fill-gradient-${this.uid}-${this._tick}`}};return o.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256,wrapMode:"clamp-to-edge"},o.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256,wrapMode:"clamp-to-edge"},o})(),Y=us;function be(o,t){for(let s=0;s<t.length;s++){let e=t[s];o.addColorStop(e.offset,e.color)}}function _e(o,t){let s=ce.get().createCanvas(o,t),e=s.getContext("2d");return{canvas:s,context:e}}function ds(o){let t=o[0]??{};return(typeof t=="number"||o[1])&&(j("8.5.2","use options object instead"),t={type:"linear",start:{x:o[0],y:o[1]},end:{x:o[2],y:o[3]},textureSpace:o[4],textureSize:o[5]??Y.defaultLinearOptions.textureSize}),t}var Pe={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}},kt=class{constructor(t,s){this.uid=$("fillPattern"),this._tick=0,this.transform=new z,this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),s&&(t.source.style.addressModeU=Pe[s].addressModeU,t.source.style.addressModeV=Pe[s].addressModeV)}setTransform(t){let s=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/s.frame.width,1/s.frame.height),this._tick++}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture=t,this._tick++)}get styleKey(){return`fill-pattern-${this.uid}-${this._tick}`}destroy(){this.texture.destroy(!0),this.texture=null}};function Me(o,t,s,e,i,r,n,a=null){let h=0;s*=t,i*=r;let l=a.a,c=a.b,u=a.c,f=a.d,d=a.tx,p=a.ty;for(;h<n;){let y=o[s],g=o[s+1];e[i]=l*y+u*g+d,e[i+1]=c*y+f*g+p,i+=r,s+=t,h++}}function Se(o,t,s,e){let i=0;for(t*=s;i<e;)o[t]=0,o[t+1]=0,t+=s,i++}function zt(o,t,s,e,i){let r=t.a,n=t.b,a=t.c,h=t.d,l=t.tx,c=t.ty;s||(s=0),e||(e=2),i||(i=o.length/e-s);let u=s*e;for(let f=0;f<i;f++){let d=o[u],p=o[u+1];o[u]=r*d+a*p+l,o[u+1]=n*d+h*p+c,u+=e}}var fs=new z,ft=class{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.renderable&&this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){let t=this.baseColor,s=t>>16|t&65280|(t&255)<<16,e=this.renderable;return e?oe(s,e.groupColor)+(this.alpha*e.groupAlpha*255<<24):s+(this.alpha*255<<24)}get transform(){return this.renderable?.groupTransform||fs}copyTo(t){t.indexOffset=this.indexOffset,t.indexSize=this.indexSize,t.attributeOffset=this.attributeOffset,t.attributeSize=this.attributeSize,t.baseColor=this.baseColor,t.alpha=this.alpha,t.texture=this.texture,t.geometryData=this.geometryData,t.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}destroy(){this.renderable=null,this.texture=null,this.geometryData=null,this._batcher=null,this._batch=null}};var it={extension:{type:B.ShapeBuilder,name:"circle"},build(o,t){let s,e,i,r,n,a;if(o.type==="circle"){let P=o;if(n=a=P.radius,n<=0)return!1;s=P.x,e=P.y,i=r=0}else if(o.type==="ellipse"){let P=o;if(n=P.halfWidth,a=P.halfHeight,n<=0||a<=0)return!1;s=P.x,e=P.y,i=r=0}else{let P=o,C=P.width/2,b=P.height/2;s=P.x+C,e=P.y+b,n=a=Math.max(0,Math.min(P.radius,Math.min(C,b))),i=C-n,r=b-a}if(i<0||r<0)return!1;let h=Math.ceil(2.3*Math.sqrt(n+a)),l=h*8+(i?4:0)+(r?4:0);if(l===0)return!1;if(h===0)return t[0]=t[6]=s+i,t[1]=t[3]=e+r,t[2]=t[4]=s-i,t[5]=t[7]=e-r,!0;let c=0,u=h*4+(i?2:0)+2,f=u,d=l,p=i+n,y=r,g=s+p,x=s-p,m=e+y;if(t[c++]=g,t[c++]=m,t[--u]=m,t[--u]=x,r){let P=e-y;t[f++]=x,t[f++]=P,t[--d]=P,t[--d]=g}for(let P=1;P<h;P++){let C=Math.PI/2*(P/h),b=i+Math.cos(C)*n,_=r+Math.sin(C)*a,I=s+b,A=s-b,S=e+_,M=e-_;t[c++]=I,t[c++]=S,t[--u]=S,t[--u]=A,t[f++]=A,t[f++]=M,t[--d]=M,t[--d]=I}p=i,y=r+a,g=s+p,x=s-p,m=e+y;let T=e-y;return t[c++]=g,t[c++]=m,t[--d]=T,t[--d]=g,i&&(t[c++]=x,t[c++]=m,t[--d]=T,t[--d]=x),!0},triangulate(o,t,s,e,i,r){if(o.length===0)return;let n=0,a=0;for(let c=0;c<o.length;c+=2)n+=o[c],a+=o[c+1];n/=o.length/2,a/=o.length/2;let h=e;t[h*s]=n,t[h*s+1]=a;let l=h++;for(let c=0;c<o.length;c+=2)t[h*s]=o[c],t[h*s+1]=o[c+1],c>0&&(i[r++]=h,i[r++]=l,i[r++]=h-1),h++;i[r++]=l+1,i[r++]=l,i[r++]=h-1}},ke=dt(G({},it),{extension:dt(G({},it.extension),{name:"ellipse"})}),Te=dt(G({},it),{extension:dt(G({},it.extension),{name:"roundedRectangle"})});function we(o,t,s,e){let i=1e-4;if(o.length===0)return;let r=o[0],n=o[1],a=o[o.length-2],h=o[o.length-1],l=t||Math.abs(r-a)<i&&Math.abs(n-h)<i,c=s,u=o.length/2,f=c.length/2;for(let d=0;d<u;d++)c.push(o[d*2]),c.push(o[d*2+1]);for(let d=0;d<u-1;d++)e.push(f+d,f+d+1);l&&e.push(f+u-1,f)}function Tt(o,t,s,e,i,r,n){let a=le(o,t,2);if(!a)return;for(let l=0;l<a.length;l+=3)r[n++]=a[l]+i,r[n++]=a[l+1]+i,r[n++]=a[l+2]+i;let h=i*e;for(let l=0;l<o.length;l+=2)s[h]=o[l],s[h+1]=o[l+1],h+=e}var ps=[],Ce={extension:{type:B.ShapeBuilder,name:"polygon"},build(o,t){for(let s=0;s<o.points.length;s++)t[s]=o.points[s];return!0},triangulate(o,t,s,e,i,r){Tt(o,ps,t,s,e,i,r)}};var Re={extension:{type:B.ShapeBuilder,name:"rectangle"},build(o,t){let s=o,e=s.x,i=s.y,r=s.width,n=s.height;return r>0&&n>0?(t[0]=e,t[1]=i,t[2]=e+r,t[3]=i,t[4]=e+r,t[5]=i+n,t[6]=e,t[7]=i+n,!0):!1},triangulate(o,t,s,e,i,r){let n=0;e*=s,t[e+n]=o[0],t[e+n+1]=o[1],n+=s,t[e+n]=o[2],t[e+n+1]=o[3],n+=s,t[e+n]=o[6],t[e+n+1]=o[7],n+=s,t[e+n]=o[4],t[e+n+1]=o[5],n+=s;let a=e/s;i[r++]=a,i[r++]=a+1,i[r++]=a+2,i[r++]=a+1,i[r++]=a+3,i[r++]=a+2}};var Ae={extension:{type:B.ShapeBuilder,name:"triangle"},build(o,t){return t[0]=o.x,t[1]=o.y,t[2]=o.x2,t[3]=o.y2,t[4]=o.x3,t[5]=o.y3,!0},triangulate(o,t,s,e,i,r){let n=0;e*=s,t[e+n]=o[0],t[e+n+1]=o[1],n+=s,t[e+n]=o[2],t[e+n+1]=o[3],n+=s,t[e+n]=o[4],t[e+n+1]=o[5];let a=e/s;i[r++]=a,i[r++]=a+1,i[r++]=a+2}};var ms=new z,ys=new F;function Ie(o,t,s,e){let i=t.matrix?o.copyFrom(t.matrix).invert():o.identity();if(t.textureSpace==="local"){let n=s.getBounds(ys);t.width&&n.pad(t.width);let{x:a,y:h}=n,l=1/n.width,c=1/n.height,u=-a*l,f=-h*c,d=i.a,p=i.b,y=i.c,g=i.d;i.a*=l,i.b*=l,i.c*=c,i.d*=c,i.tx=u*d+f*y+i.tx,i.ty=u*p+f*g+i.ty}else i.translate(t.texture.frame.x,t.texture.frame.y),i.scale(1/t.texture.source.width,1/t.texture.source.height);let r=t.texture.source.style;return!(t.fill instanceof Y)&&r.addressMode==="clamp-to-edge"&&(r.addressMode="repeat",r.update()),e&&i.append(ms.copyFrom(e).invert()),i}var wt={};qt.handleByMap(B.ShapeBuilder,wt);qt.add(Re,Ce,Ae,it,ke,Te);var gs=new F,xs=new z;function Ge(o,t){let{geometryData:s,batches:e}=t;e.length=0,s.indices.length=0,s.vertices.length=0,s.uvs.length=0;for(let i=0;i<o.instructions.length;i++){let r=o.instructions[i];if(r.action==="texture")bs(r.data,e,s);else if(r.action==="fill"||r.action==="stroke"){let n=r.action==="stroke",a=r.data.path.shapePath,h=r.data.style,l=r.data.hole;n&&l&&De(l.shapePath,h,!0,e,s),l&&(a.shapePrimitives[a.shapePrimitives.length-1].holes=l.shapePath.shapePrimitives),De(a,h,n,e,s)}}}function bs(o,t,s){let e=[],i=wt.rectangle,r=gs;r.x=o.dx,r.y=o.dy,r.width=o.dw,r.height=o.dh;let n=o.transform;if(!i.build(r,e))return;let{vertices:a,uvs:h,indices:l}=s,c=l.length,u=a.length/2;n&&zt(e,n),i.triangulate(e,a,2,u,l,c);let f=o.image,d=f.uvs;h.push(d.x0,d.y0,d.x1,d.y1,d.x3,d.y3,d.x2,d.y2);let p=J.get(ft);p.indexOffset=c,p.indexSize=l.length-c,p.attributeOffset=u,p.attributeSize=a.length/2-u,p.baseColor=o.style,p.alpha=o.alpha,p.texture=f,p.geometryData=s,t.push(p)}function De(o,t,s,e,i){let{vertices:r,uvs:n,indices:a}=i;o.shapePrimitives.forEach(({shape:h,transform:l,holes:c})=>{let u=[],f=wt[h.type];if(!f.build(h,u))return;let d=a.length,p=r.length/2,y="triangle-list";if(l&&zt(u,l),s){let T=h.closePath??!0,P=t;P.pixelLine?(we(u,T,r,a),y="line-list"):ge(u,P,!1,T,r,a)}else if(c){let T=[],P=u.slice();_s(c).forEach(b=>{T.push(P.length/2),P.push(...b)}),Tt(P,T,r,2,p,a,d)}else f.triangulate(u,r,2,p,a,d);let g=n.length/2,x=t.texture;if(x!==V.WHITE){let T=Ie(xs,t,h,l);Me(r,2,p,n,g,2,r.length/2-p,T)}else Se(n,g,2,r.length/2-p);let m=J.get(ft);m.indexOffset=d,m.indexSize=a.length-d,m.attributeOffset=p,m.attributeSize=r.length/2-p,m.baseColor=t.color,m.alpha=t.alpha,m.texture=x,m.geometryData=i,m.topology=y,e.push(m)})}function _s(o){let t=[];for(let s=0;s<o.length;s++){let e=o[s].shape,i=[];wt[e.type].build(e,i)&&t.push(i)}return t}var Le=os(ve(),1);function ze(o,t){let s=(0,Le.default)(o),e=[],i=null,r=0,n=0;for(let a=0;a<s.length;a++){let h=s[a],l=h[0],c=h;switch(l){case"M":r=c[1],n=c[2],t.moveTo(r,n);break;case"m":r+=c[1],n+=c[2],t.moveTo(r,n);break;case"H":r=c[1],t.lineTo(r,n);break;case"h":r+=c[1],t.lineTo(r,n);break;case"V":n=c[1],t.lineTo(r,n);break;case"v":n+=c[1],t.lineTo(r,n);break;case"L":r=c[1],n=c[2],t.lineTo(r,n);break;case"l":r+=c[1],n+=c[2],t.lineTo(r,n);break;case"C":r=c[5],n=c[6],t.bezierCurveTo(c[1],c[2],c[3],c[4],r,n);break;case"c":t.bezierCurveTo(r+c[1],n+c[2],r+c[3],n+c[4],r+c[5],n+c[6]),r+=c[5],n+=c[6];break;case"S":r=c[3],n=c[4],t.bezierCurveToShort(c[1],c[2],r,n);break;case"s":t.bezierCurveToShort(r+c[1],n+c[2],r+c[3],n+c[4]),r+=c[3],n+=c[4];break;case"Q":r=c[3],n=c[4],t.quadraticCurveTo(c[1],c[2],r,n);break;case"q":t.quadraticCurveTo(r+c[1],n+c[2],r+c[3],n+c[4]),r+=c[3],n+=c[4];break;case"T":r=c[1],n=c[2],t.quadraticCurveToShort(r,n);break;case"t":r+=c[1],n+=c[2],t.quadraticCurveToShort(r,n);break;case"A":r=c[6],n=c[7],t.arcToSvg(c[1],c[2],c[3],c[4],c[5],r,n);break;case"a":r+=c[6],n+=c[7],t.arcToSvg(c[1],c[2],c[3],c[4],c[5],r,n);break;case"Z":case"z":t.closePath(),e.length>0&&(i=e.pop(),i?(r=i.startX,n=i.startY):(r=0,n=0)),i=null;break;default:X(`Unknown SVG path command: ${l}`)}l!=="Z"&&l!=="z"&&i===null&&(i={startX:r,startY:n},e.push(i))}return t}var Bt=class{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}reset(){this.batches&&this.batches.forEach(t=>{J.return(t)}),this.graphicsData&&J.return(this.graphicsData),this.isBatchable=!1,this.context=null,this.batches.length=0,this.geometryData.indices.length=0,this.geometryData.vertices.length=0,this.geometryData.uvs.length=0,this.graphicsData=null}destroy(){this.reset(),this.batches=null,this.geometryData=null}},Et=class{constructor(){this.instructions=new ae}init(t){let s=t.maxTextures;this.batcher?this.batcher._updateMaxTextures(s):this.batcher=new de({maxTextures:s}),this.instructions.reset()}get geometry(){return j(ne,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}destroy(){this.batcher.destroy(),this.instructions.destroy(),this.batcher=null,this.instructions=null}},Vt=class Ht{constructor(t){this._renderer=t,this._managedContexts=new fe({renderer:t,type:"resource",name:"graphicsContext"})}init(t){Ht.defaultOptions.bezierSmoothness=t?.bezierSmoothness??Ht.defaultOptions.bezierSmoothness}getContextRenderData(t){return t._gpuData[this._renderer.uid].graphicsData||this._initContextRenderData(t)}updateGpuContext(t){let s=!!t._gpuData[this._renderer.uid],e=t._gpuData[this._renderer.uid]||this._initContext(t);if(t.dirty||!s){s&&e.reset(),Ge(t,e);let i=t.batchMode;t.customShader||i==="no-batch"?e.isBatchable=!1:i==="auto"?e.isBatchable=e.geometryData.vertices.length<400:e.isBatchable=!0,t.dirty=!1}return e}getGpuContext(t){return t._gpuData[this._renderer.uid]||this._initContext(t)}_initContextRenderData(t){let s=J.get(Et,{maxTextures:this._renderer.limits.maxBatchableTextures}),e=t._gpuData[this._renderer.uid],{batches:i,geometryData:r}=e;e.graphicsData=s;let n=r.vertices.length,a=r.indices.length;for(let u=0;u<i.length;u++)i[u].applyTransform=!1;let h=s.batcher;h.ensureAttributeBuffer(n),h.ensureIndexBuffer(a),h.begin();for(let u=0;u<i.length;u++){let f=i[u];h.add(f)}h.finish(s.instructions);let l=h.geometry;l.indexBuffer.setDataWithSize(h.indexBuffer,h.indexSize,!0),l.buffers[0].setDataWithSize(h.attributeBuffer.float32View,h.attributeSize,!0);let c=h.batches;for(let u=0;u<c.length;u++){let f=c[u];f.bindGroup=ue(f.textures.textures,f.textures.count,this._renderer.limits.maxBatchableTextures)}return s}_initContext(t){let s=new Bt;return s.context=t,t._gpuData[this._renderer.uid]=s,this._managedContexts.add(t),s}destroy(){this._managedContexts.destroy(),this._renderer=null}};Vt.extension={type:[B.WebGLSystem,B.WebGPUSystem],name:"graphicsContext"};Vt.defaultOptions={bezierSmoothness:.5};var Ct=Vt;var Ts=8,Rt=11920929e-14,ws=1,Wt=.01,nt=0,et=0;function At(o,t,s,e,i,r,n,a,h,l){let u=Math.min(.99,Math.max(0,l??Ct.defaultOptions.bezierSmoothness)),f=(ws-u)/1;return f*=f,Cs(t,s,e,i,r,n,a,h,o,f),o}function Cs(o,t,s,e,i,r,n,a,h,l){Nt(o,t,s,e,i,r,n,a,h,l,0),h.push(n,a)}function Nt(o,t,s,e,i,r,n,a,h,l,c){if(c>Ts)return;let u=Math.PI,f=(o+s)/2,d=(t+e)/2,p=(s+i)/2,y=(e+r)/2,g=(i+n)/2,x=(r+a)/2,m=(f+p)/2,T=(d+y)/2,P=(p+g)/2,C=(y+x)/2,b=(m+P)/2,_=(T+C)/2;if(c>0){let I=n-o,A=a-t,S=Math.abs((s-n)*A-(e-a)*I),M=Math.abs((i-n)*A-(r-a)*I),R,q;if(S>Rt&&M>Rt){if((S+M)*(S+M)<=l*(I*I+A*A)){if(nt<Wt){h.push(b,_);return}let v=Math.atan2(r-e,i-s);if(R=Math.abs(v-Math.atan2(e-t,s-o)),q=Math.abs(Math.atan2(a-r,n-i)-v),R>=u&&(R=2*u-R),q>=u&&(q=2*u-q),R+q<nt){h.push(b,_);return}if(et!==0){if(R>et){h.push(s,e);return}if(q>et){h.push(i,r);return}}}}else if(S>Rt){if(S*S<=l*(I*I+A*A)){if(nt<Wt){h.push(b,_);return}if(R=Math.abs(Math.atan2(r-e,i-s)-Math.atan2(e-t,s-o)),R>=u&&(R=2*u-R),R<nt){h.push(s,e),h.push(i,r);return}if(et!==0&&R>et){h.push(s,e);return}}}else if(M>Rt){if(M*M<=l*(I*I+A*A)){if(nt<Wt){h.push(b,_);return}if(R=Math.abs(Math.atan2(a-r,n-i)-Math.atan2(r-e,i-s)),R>=u&&(R=2*u-R),R<nt){h.push(s,e),h.push(i,r);return}if(et!==0&&R>et){h.push(i,r);return}}}else if(I=b-(o+n)/2,A=_-(t+a)/2,I*I+A*A<=l){h.push(b,_);return}}Nt(o,t,f,d,m,T,b,_,h,l,c+1),Nt(b,_,P,C,g,x,n,a,h,l,c+1)}var Rs=8,As=11920929e-14,Is=1,Ds=.01,Fe=0;function Be(o,t,s,e,i,r,n,a){let l=Math.min(.99,Math.max(0,a??Ct.defaultOptions.bezierSmoothness)),c=(Is-l)/1;return c*=c,Gs(t,s,e,i,r,n,o,c),o}function Gs(o,t,s,e,i,r,n,a){jt(n,o,t,s,e,i,r,a,0),n.push(i,r)}function jt(o,t,s,e,i,r,n,a,h){if(h>Rs)return;let l=Math.PI,c=(t+e)/2,u=(s+i)/2,f=(e+r)/2,d=(i+n)/2,p=(c+f)/2,y=(u+d)/2,g=r-t,x=n-s,m=Math.abs((e-r)*x-(i-n)*g);if(m>As){if(m*m<=a*(g*g+x*x)){if(Fe<Ds){o.push(p,y);return}let T=Math.abs(Math.atan2(n-i,r-e)-Math.atan2(i-s,e-t));if(T>=l&&(T=2*l-T),T<Fe){o.push(p,y);return}}}else if(g=p-(t+r)/2,x=y-(s+n)/2,g*g+x*x<=a){o.push(p,y);return}jt(o,t,s,c,u,p,y,a,h+1),jt(o,p,y,f,d,r,n,a,h+1)}function It(o,t,s,e,i,r,n,a){let h=Math.abs(i-r);(!n&&i>r||n&&r>i)&&(h=2*Math.PI-h),a||(a=Math.max(6,Math.floor(6*Math.pow(e,1/3)*(h/Math.PI)))),a=Math.max(a,3);let l=h/a,c=i;l*=n?-1:1;for(let u=0;u<a+1;u++){let f=Math.cos(c),d=Math.sin(c),p=t+f*e,y=s+d*e;o.push(p,y),c+=l}}function Ee(o,t,s,e,i,r){let n=o[o.length-2],h=o[o.length-1]-s,l=n-t,c=i-s,u=e-t,f=Math.abs(h*u-l*c);if(f<1e-8||r===0){(o[o.length-2]!==t||o[o.length-1]!==s)&&o.push(t,s);return}let d=h*h+l*l,p=c*c+u*u,y=h*c+l*u,g=r*Math.sqrt(d)/f,x=r*Math.sqrt(p)/f,m=g*y/d,T=x*y/p,P=g*u+x*l,C=g*c+x*h,b=l*(x+m),_=h*(x+m),I=u*(g+T),A=c*(g+T),S=Math.atan2(_-C,b-P),M=Math.atan2(A-C,I-P);It(o,P+t,C+s,r,S,M,l*c>u*h)}var pt=Math.PI*2,Ut={centerX:0,centerY:0,ang1:0,ang2:0},$t=({x:o,y:t},s,e,i,r,n,a,h)=>{o*=s,t*=e;let l=i*o-r*t,c=r*o+i*t;return h.x=l+n,h.y=c+a,h};function qs(o,t){let s=t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),e=t===1.5707963267948966?.551915024494:s,i=Math.cos(o),r=Math.sin(o),n=Math.cos(o+t),a=Math.sin(o+t);return[{x:i-r*e,y:r+i*e},{x:n+a*e,y:a-n*e},{x:n,y:a}]}var He=(o,t,s,e)=>{let i=o*e-t*s<0?-1:1,r=o*s+t*e;return r>1&&(r=1),r<-1&&(r=-1),i*Math.acos(r)},vs=(o,t,s,e,i,r,n,a,h,l,c,u,f)=>{let d=Math.pow(i,2),p=Math.pow(r,2),y=Math.pow(c,2),g=Math.pow(u,2),x=d*p-d*g-p*y;x<0&&(x=0),x/=d*g+p*y,x=Math.sqrt(x)*(n===a?-1:1);let m=x*i/r*u,T=x*-r/i*c,P=l*m-h*T+(o+s)/2,C=h*m+l*T+(t+e)/2,b=(c-m)/i,_=(u-T)/r,I=(-c-m)/i,A=(-u-T)/r,S=He(1,0,b,_),M=He(b,_,I,A);a===0&&M>0&&(M-=pt),a===1&&M<0&&(M+=pt),f.centerX=P,f.centerY=C,f.ang1=S,f.ang2=M};function Ve(o,t,s,e,i,r,n,a=0,h=0,l=0){if(r===0||n===0)return;let c=Math.sin(a*pt/360),u=Math.cos(a*pt/360),f=u*(t-e)/2+c*(s-i)/2,d=-c*(t-e)/2+u*(s-i)/2;if(f===0&&d===0)return;r=Math.abs(r),n=Math.abs(n);let p=Math.pow(f,2)/Math.pow(r,2)+Math.pow(d,2)/Math.pow(n,2);p>1&&(r*=Math.sqrt(p),n*=Math.sqrt(p)),vs(t,s,e,i,r,n,h,l,c,u,f,d,Ut);let{ang1:y,ang2:g}=Ut,{centerX:x,centerY:m}=Ut,T=Math.abs(g)/(pt/4);Math.abs(1-T)<1e-7&&(T=1);let P=Math.max(Math.ceil(T),1);g/=P;let C=o[o.length-2],b=o[o.length-1],_={x:0,y:0};for(let I=0;I<P;I++){let A=qs(y,g),{x:S,y:M}=$t(A[0],r,n,u,c,x,m,_),{x:R,y:q}=$t(A[1],r,n,u,c,x,m,_),{x:v,y:st}=$t(A[2],r,n,u,c,x,m,_);At(o,C,b,S,M,R,q,v,st),C=v,b=st,y+=g}}function We(o,t,s){let e=(n,a)=>{let h=a.x-n.x,l=a.y-n.y,c=Math.sqrt(h*h+l*l),u=h/c,f=l/c;return{len:c,nx:u,ny:f}},i=(n,a)=>{n===0?o.moveTo(a.x,a.y):o.lineTo(a.x,a.y)},r=t[t.length-1];for(let n=0;n<t.length;n++){let a=t[n%t.length],h=a.radius??s;if(h<=0){i(n,a),r=a;continue}let l=t[(n+1)%t.length],c=e(a,r),u=e(a,l);if(c.len<1e-4||u.len<1e-4){i(n,a),r=a;continue}let f=Math.asin(c.nx*u.ny-c.ny*u.nx),d=1,p=!1;c.nx*u.nx-c.ny*-u.ny<0?f<0?f=Math.PI+f:(f=Math.PI-f,d=-1,p=!0):f>0&&(d=-1,p=!0);let y=f/2,g,x=Math.abs(Math.cos(y)*h/Math.sin(y));x>Math.min(c.len/2,u.len/2)?(x=Math.min(c.len/2,u.len/2),g=Math.abs(x*Math.sin(y)/Math.cos(y))):g=h;let m=a.x+u.nx*x+-u.ny*g*d,T=a.y+u.ny*x+u.nx*g*d,P=Math.atan2(c.ny,c.nx)+Math.PI/2*d,C=Math.atan2(u.ny,u.nx)-Math.PI/2*d;n===0&&o.moveTo(m+Math.cos(P)*g,T+Math.sin(P)*g),o.arc(m,T,g,P,C,p),r=a}}function Ne(o,t,s,e){let i=(a,h)=>Math.sqrt((a.x-h.x)**2+(a.y-h.y)**2),r=(a,h,l)=>({x:a.x+(h.x-a.x)*l,y:a.y+(h.y-a.y)*l}),n=t.length;for(let a=0;a<n;a++){let h=t[(a+1)%n],l=h.radius??s;if(l<=0){a===0?o.moveTo(h.x,h.y):o.lineTo(h.x,h.y);continue}let c=t[a],u=t[(a+2)%n],f=i(c,h),d;if(f<1e-4)d=h;else{let g=Math.min(f/2,l);d=r(h,c,g/f)}let p=i(u,h),y;if(p<1e-4)y=h;else{let g=Math.min(p/2,l);y=r(h,u,g/p)}a===0?o.moveTo(d.x,d.y):o.lineTo(d.x,d.y),o.quadraticCurveTo(h.x,h.y,y.x,y.y,e)}}var Ls=new F,Dt=class{constructor(t){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new bt,this._graphicsPath2D=t,this.signed=t.checkForHoles}moveTo(t,s){return this.startPoly(t,s),this}lineTo(t,s){this._ensurePoly();let e=this._currentPoly.points,i=e[e.length-2],r=e[e.length-1];return(i!==t||r!==s)&&e.push(t,s),this}arc(t,s,e,i,r,n){this._ensurePoly(!1);let a=this._currentPoly.points;return It(a,t,s,e,i,r,n),this}arcTo(t,s,e,i,r){this._ensurePoly();let n=this._currentPoly.points;return Ee(n,t,s,e,i,r),this}arcToSvg(t,s,e,i,r,n,a){let h=this._currentPoly.points;return Ve(h,this._currentPoly.lastX,this._currentPoly.lastY,n,a,t,s,e,i,r),this}bezierCurveTo(t,s,e,i,r,n,a){this._ensurePoly();let h=this._currentPoly;return At(this._currentPoly.points,h.lastX,h.lastY,t,s,e,i,r,n,a),this}quadraticCurveTo(t,s,e,i,r){this._ensurePoly();let n=this._currentPoly;return Be(this._currentPoly.points,n.lastX,n.lastY,t,s,e,i,r),this}closePath(){return this.endPoly(!0),this}addPath(t,s){this.endPoly(),s&&!s.isIdentity()&&(t=t.clone(!0),t.transform(s));let e=this.shapePrimitives,i=e.length;for(let r=0;r<t.instructions.length;r++){let n=t.instructions[r];this[n.action](...n.data)}if(t.checkForHoles&&e.length-i>1){let r=null;for(let n=i;n<e.length;n++){let a=e[n];if(a.shape.type==="polygon"){let h=a.shape,l=r?.shape;l&&l.containsPolygon(h)?(r.holes||(r.holes=[]),r.holes.push(a),e.copyWithin(n,n+1),e.length--,n--):r=a}}}return this}finish(t=!1){this.endPoly(t)}rect(t,s,e,i,r){return this.drawShape(new F(t,s,e,i),r),this}circle(t,s,e,i){return this.drawShape(new _t(t,s,e),i),this}poly(t,s,e){let i=new rt(t);return i.closePath=s,this.drawShape(i,e),this}regularPoly(t,s,e,i,r=0,n){i=Math.max(i|0,3);let a=-1*Math.PI/2+r,h=Math.PI*2/i,l=[];for(let c=0;c<i;c++){let u=a-c*h;l.push(t+e*Math.cos(u),s+e*Math.sin(u))}return this.poly(l,!0,n),this}roundPoly(t,s,e,i,r,n=0,a){if(i=Math.max(i|0,3),r<=0)return this.regularPoly(t,s,e,i,n);let h=e*Math.sin(Math.PI/i)-.001;r=Math.min(r,h);let l=-1*Math.PI/2+n,c=Math.PI*2/i,u=(i-2)*Math.PI/i/2;for(let f=0;f<i;f++){let d=f*c+l,p=t+e*Math.cos(d),y=s+e*Math.sin(d),g=d+Math.PI+u,x=d-Math.PI-u,m=p+r*Math.cos(g),T=y+r*Math.sin(g),P=p+r*Math.cos(x),C=y+r*Math.sin(x);f===0?this.moveTo(m,T):this.lineTo(m,T),this.quadraticCurveTo(p,y,P,C,a)}return this.closePath()}roundShape(t,s,e=!1,i){return t.length<3?this:(e?Ne(this,t,s,i):We(this,t,s),this.closePath())}filletRect(t,s,e,i,r){if(r===0)return this.rect(t,s,e,i);let n=Math.min(e,i)/2,a=Math.min(n,Math.max(-n,r)),h=t+e,l=s+i,c=a<0?-a:0,u=Math.abs(a);return this.moveTo(t,s+u).arcTo(t+c,s+c,t+u,s,u).lineTo(h-u,s).arcTo(h-c,s+c,h,s+u,u).lineTo(h,l-u).arcTo(h-c,l-c,t+e-u,l,u).lineTo(t+u,l).arcTo(t+c,l-c,t,l-u,u).closePath()}chamferRect(t,s,e,i,r,n){if(r<=0)return this.rect(t,s,e,i);let a=Math.min(r,Math.min(e,i)/2),h=t+e,l=s+i,c=[t+a,s,h-a,s,h,s+a,h,l-a,h-a,l,t+a,l,t,l-a,t,s+a];for(let u=c.length-1;u>=2;u-=2)c[u]===c[u-2]&&c[u-1]===c[u-3]&&c.splice(u-1,2);return this.poly(c,!0,n)}ellipse(t,s,e,i,r){return this.drawShape(new Pt(t,s,e,i),r),this}roundRect(t,s,e,i,r,n){return this.drawShape(new St(t,s,e,i,r),n),this}drawShape(t,s){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:s}),this}startPoly(t,s){let e=this._currentPoly;return e&&this.endPoly(),e=new rt,e.points.push(t,s),this._currentPoly=e,this}endPoly(t=!1){let s=this._currentPoly;return s&&s.points.length>2&&(s.closePath=t,this.shapePrimitives.push({shape:s})),this._currentPoly=null,this}_ensurePoly(t=!0){if(!this._currentPoly&&(this._currentPoly=new rt,t)){let s=this.shapePrimitives[this.shapePrimitives.length-1];if(s){let e=s.shape.x,i=s.shape.y;if(s.transform&&!s.transform.isIdentity()){let r=s.transform,n=e;e=r.a*e+r.c*i+r.tx,i=r.b*n+r.d*i+r.ty}this._currentPoly.points.push(e,i)}else this._currentPoly.points.push(0,0)}}buildPath(){let t=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let s=0;s<t.instructions.length;s++){let e=t.instructions[s];this[e.action](...e.data)}this.finish()}get bounds(){let t=this._bounds;t.clear();let s=this.shapePrimitives;for(let e=0;e<s.length;e++){let i=s[e],r=i.shape.getBounds(Ls);i.transform?t.addRect(r,i.transform):t.addRect(r)}return t}};var H=class o{constructor(t,s=!1){this.instructions=[],this.uid=$("graphicsPath"),this._dirty=!0,this.checkForHoles=s,typeof t=="string"?ze(t,this):this.instructions=t?.slice()??[]}get shapePath(){return this._shapePath||(this._shapePath=new Dt(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,s){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,s]}),this._dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}bezierCurveToShort(t,s,e,i,r){let n=this.instructions[this.instructions.length-1],a=this.getLastPoint(N.shared),h=0,l=0;if(!n||n.action!=="bezierCurveTo")h=a.x,l=a.y;else{h=n.data[2],l=n.data[3];let c=a.x,u=a.y;h=c+(c-h),l=u+(u-l)}return this.instructions.push({action:"bezierCurveTo",data:[h,l,t,s,e,i,r]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}quadraticCurveToShort(t,s,e){let i=this.instructions[this.instructions.length-1],r=this.getLastPoint(N.shared),n=0,a=0;if(!i||i.action!=="quadraticCurveTo")n=r.x,a=r.y;else{n=i.data[0],a=i.data[1];let h=r.x,l=r.y;n=h+(h-n),a=l+(l-a)}return this.instructions.push({action:"quadraticCurveTo",data:[n,a,t,s,e]}),this._dirty=!0,this}rect(t,s,e,i,r){return this.instructions.push({action:"rect",data:[t,s,e,i,r]}),this._dirty=!0,this}circle(t,s,e,i){return this.instructions.push({action:"circle",data:[t,s,e,i]}),this._dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}star(t,s,e,i,r,n,a){r||(r=i/2);let h=-1*Math.PI/2+n,l=e*2,c=Math.PI*2/l,u=[];for(let f=0;f<l;f++){let d=f%2?r:i,p=f*c+h;u.push(t+d*Math.cos(p),s+d*Math.sin(p))}return this.poly(u,!0,a),this}clone(t=!1){let s=new o;if(s.checkForHoles=this.checkForHoles,!t)s.instructions=this.instructions.slice();else for(let e=0;e<this.instructions.length;e++){let i=this.instructions[e];s.instructions.push({action:i.action,data:i.data.slice()})}return s}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(t){if(t.isIdentity())return this;let s=t.a,e=t.b,i=t.c,r=t.d,n=t.tx,a=t.ty,h=0,l=0,c=0,u=0,f=0,d=0,p=0,y=0;for(let g=0;g<this.instructions.length;g++){let x=this.instructions[g],m=x.data;switch(x.action){case"moveTo":case"lineTo":h=m[0],l=m[1],m[0]=s*h+i*l+n,m[1]=e*h+r*l+a;break;case"bezierCurveTo":c=m[0],u=m[1],f=m[2],d=m[3],h=m[4],l=m[5],m[0]=s*c+i*u+n,m[1]=e*c+r*u+a,m[2]=s*f+i*d+n,m[3]=e*f+r*d+a,m[4]=s*h+i*l+n,m[5]=e*h+r*l+a;break;case"quadraticCurveTo":c=m[0],u=m[1],h=m[2],l=m[3],m[0]=s*c+i*u+n,m[1]=e*c+r*u+a,m[2]=s*h+i*l+n,m[3]=e*h+r*l+a;break;case"arcToSvg":h=m[5],l=m[6],p=m[0],y=m[1],m[0]=s*p+i*y,m[1]=e*p+r*y,m[5]=s*h+i*l+n,m[6]=e*h+r*l+a;break;case"circle":m[4]=mt(m[3],t);break;case"rect":m[4]=mt(m[4],t);break;case"ellipse":m[8]=mt(m[8],t);break;case"roundRect":m[5]=mt(m[5],t);break;case"addPath":m[0].transform(t);break;case"poly":m[2]=mt(m[2],t);break;default:X("unknown transform action",x.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let s=this.instructions.length-1,e=this.instructions[s];if(!e)return t.x=0,t.y=0,t;for(;e.action==="closePath";){if(s--,s<0)return t.x=0,t.y=0,t;e=this.instructions[s]}switch(e.action){case"moveTo":case"lineTo":t.x=e.data[0],t.y=e.data[1];break;case"quadraticCurveTo":t.x=e.data[2],t.y=e.data[3];break;case"bezierCurveTo":t.x=e.data[4],t.y=e.data[5];break;case"arc":case"arcToSvg":t.x=e.data[5],t.y=e.data[6];break;case"addPath":e.data[0].getLastPoint(t);break}return t}};function mt(o,t){return o?o.prepend(t):t.clone()}function L(o,t,s){let e=o.getAttribute(t);return e?Number(e):s}function je(o,t){let s=o.querySelectorAll("defs");for(let e=0;e<s.length;e++){let i=s[e];for(let r=0;r<i.children.length;r++){let n=i.children[r];switch(n.nodeName.toLowerCase()){case"lineargradient":t.defs[n.id]=zs(n);break;case"radialgradient":t.defs[n.id]=Fs(n);break;default:break}}}}function zs(o){let t=L(o,"x1",0),s=L(o,"y1",0),e=L(o,"x2",1),i=L(o,"y2",0),r=o.getAttribute("gradientUnits")||"objectBoundingBox",n=new Y(t,s,e,i,r==="objectBoundingBox"?"local":"global");for(let a=0;a<o.children.length;a++){let h=o.children[a],l=L(h,"offset",0),c=E.shared.setValue(h.getAttribute("stop-color")).toNumber();n.addColorStop(l,c)}return n}function Fs(o){return X("[SVG Parser] Radial gradients are not yet supported"),new Y(0,0,1,0)}function Xt(o){let t=o.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return t?t[1]:""}var Ue={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function Yt(o,t){let s=o.getAttribute("style"),e={},i={},r={strokeStyle:e,fillStyle:i,useFill:!1,useStroke:!1};for(let n in Ue){let a=o.getAttribute(n);a&&$e(t,r,n,a.trim())}if(s){let n=s.split(";");for(let a=0;a<n.length;a++){let h=n[a].trim(),[l,c]=h.split(":");Ue[l]&&$e(t,r,l,c.trim())}}return{strokeStyle:r.useStroke?e:null,fillStyle:r.useFill?i:null,useFill:r.useFill,useStroke:r.useStroke}}function $e(o,t,s,e){switch(s){case"stroke":if(e!=="none"){if(e.startsWith("url(")){let i=Xt(e);t.strokeStyle.fill=o.defs[i]}else t.strokeStyle.color=E.shared.setValue(e).toNumber();t.useStroke=!0}break;case"stroke-width":t.strokeStyle.width=Number(e);break;case"fill":if(e!=="none"){if(e.startsWith("url(")){let i=Xt(e);t.fillStyle.fill=o.defs[i]}else t.fillStyle.color=E.shared.setValue(e).toNumber();t.useFill=!0}break;case"fill-opacity":t.fillStyle.alpha=Number(e);break;case"stroke-opacity":t.strokeStyle.alpha=Number(e);break;case"opacity":t.fillStyle.alpha=Number(e),t.strokeStyle.alpha=Number(e);break}}function Xe(o){if(o.length<=2)return!0;let t=o.map(a=>a.area).sort((a,h)=>h-a),[s,e]=t,i=t[t.length-1],r=s/e,n=e/i;return!(r>3&&n<2)}function Ye(o){return o.split(/(?=[Mm])/).filter(e=>e.trim().length>0)}function Qe(o){let t=o.match(/[-+]?[0-9]*\.?[0-9]+/g);if(!t||t.length<4)return 0;let s=t.map(Number),e=[],i=[];for(let c=0;c<s.length;c+=2)c+1<s.length&&(e.push(s[c]),i.push(s[c+1]));if(e.length===0||i.length===0)return 0;let r=Math.min(...e),n=Math.max(...e),a=Math.min(...i),h=Math.max(...i);return(n-r)*(h-a)}function Qt(o,t){let s=new H(o,!1);for(let e of s.instructions)t.instructions.push(e)}function Oe(o,t){if(typeof o=="string"){let n=document.createElement("div");n.innerHTML=o.trim(),o=n.querySelector("svg")}let s={context:t,defs:{},path:new H};je(o,s);let e=o.children,{fillStyle:i,strokeStyle:r}=Yt(o,s);for(let n=0;n<e.length;n++){let a=e[n];a.nodeName.toLowerCase()!=="defs"&&Ke(a,s,i,r)}return t}function Ke(o,t,s,e){let i=o.children,{fillStyle:r,strokeStyle:n}=Yt(o,t);r&&s?s=G(G({},s),r):r&&(s=r),n&&e?e=G(G({},e),n):n&&(e=n);let a=!s&&!e;a&&(s={color:0});let h,l,c,u,f,d,p,y,g,x,m,T,P,C,b,_,I;switch(o.nodeName.toLowerCase()){case"path":{C=o.getAttribute("d");let A=o.getAttribute("fill-rule"),S=Ye(C),M=A==="evenodd",R=S.length>1;if(M&&R){let v=S.map(k=>({path:k,area:Qe(k)}));if(v.sort((k,w)=>w.area-k.area),S.length>3||!Xe(v))for(let k=0;k<v.length;k++){let w=v[k],at=k===0;t.context.beginPath();let D=new H(void 0,!0);Qt(w.path,D),t.context.path(D),at?(s&&t.context.fill(s),e&&t.context.stroke(e)):t.context.cut()}else for(let k=0;k<v.length;k++){let w=v[k],at=k%2===1;t.context.beginPath();let D=new H(void 0,!0);Qt(w.path,D),t.context.path(D),at?t.context.cut():(s&&t.context.fill(s),e&&t.context.stroke(e))}}else{let v=A?A==="evenodd":!0;b=new H(C,v),t.context.path(b),s&&t.context.fill(s),e&&t.context.stroke(e)}break}case"circle":p=L(o,"cx",0),y=L(o,"cy",0),g=L(o,"r",0),t.context.ellipse(p,y,g,g),s&&t.context.fill(s),e&&t.context.stroke(e);break;case"rect":h=L(o,"x",0),l=L(o,"y",0),_=L(o,"width",0),I=L(o,"height",0),x=L(o,"rx",0),m=L(o,"ry",0),x||m?t.context.roundRect(h,l,_,I,x||m):t.context.rect(h,l,_,I),s&&t.context.fill(s),e&&t.context.stroke(e);break;case"ellipse":p=L(o,"cx",0),y=L(o,"cy",0),x=L(o,"rx",0),m=L(o,"ry",0),t.context.beginPath(),t.context.ellipse(p,y,x,m),s&&t.context.fill(s),e&&t.context.stroke(e);break;case"line":c=L(o,"x1",0),u=L(o,"y1",0),f=L(o,"x2",0),d=L(o,"y2",0),t.context.beginPath(),t.context.moveTo(c,u),t.context.lineTo(f,d),e&&t.context.stroke(e);break;case"polygon":P=o.getAttribute("points"),T=P.match(/-?\d+/g).map(A=>parseInt(A,10)),t.context.poly(T,!0),s&&t.context.fill(s),e&&t.context.stroke(e);break;case"polyline":P=o.getAttribute("points"),T=P.match(/-?\d+/g).map(A=>parseInt(A,10)),t.context.poly(T,!1),e&&t.context.stroke(e);break;case"g":case"svg":break;default:{X(`[SVG parser] <${o.nodeName}> elements unsupported`);break}}a&&(s=null);for(let A=0;A<i.length;A++)Ke(i[A],t,s,e)}function Bs(o){return E.isColorLike(o)}function Ze(o){return o instanceof kt}function Je(o){return o instanceof Y}function Es(o){return o instanceof V}function Hs(o,t,s){let e=E.shared.setValue(t??0);return o.color=e.toNumber(),o.alpha=e.alpha===1?s.alpha:e.alpha,o.texture=V.WHITE,G(G({},s),o)}function Vs(o,t,s){return o.texture=t,G(G({},s),o)}function ts(o,t,s){return o.fill=t,o.color=16777215,o.texture=t.texture,o.matrix=t.transform,G(G({},s),o)}function es(o,t,s){return t.buildGradient(),o.fill=t,o.color=16777215,o.texture=t.texture,o.matrix=t.transform,o.textureSpace=t.textureSpace,G(G({},s),o)}function Ws(o,t){let s=G(G({},t),o),e=E.shared.setValue(s.color);return s.alpha*=e.alpha,s.color=e.toNumber(),s}function ot(o,t){if(o==null)return null;let s={},e=o;return Bs(o)?Hs(s,o,t):Es(o)?Vs(s,o,t):Ze(o)?ts(s,o,t):Je(o)?es(s,o,t):e.fill&&Ze(e.fill)?ts(e,e.fill,t):e.fill&&Je(e.fill)?es(e,e.fill,t):Ws(e,t)}function Ot(o,t){let c=t,{width:s,alignment:e,miterLimit:i,cap:r,join:n,pixelLine:a}=c,h=se(c,["width","alignment","miterLimit","cap","join","pixelLine"]),l=ot(o,h);return l?G({width:s,alignment:e,miterLimit:i,cap:r,join:n,pixelLine:a},l):null}var Ns=new N,ss=new z,Kt=class W extends re{constructor(){super(...arguments),this._gpuData=Object.create(null),this.autoGarbageCollect=!0,this._gcLastUsed=-1,this.uid=$("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this.destroyed=!1,this._activePath=new H,this._transform=new z,this._fillStyle=G({},W.defaultFillStyle),this._strokeStyle=G({},W.defaultStrokeStyle),this._stateStack=[],this._tick=0,this._bounds=new bt,this._boundsDirty=!0}clone(){let t=new W;return t.batchMode=this.batchMode,t.instructions=this.instructions.slice(),t._activePath=this._activePath.clone(),t._transform=this._transform.clone(),t._fillStyle=G({},this._fillStyle),t._strokeStyle=G({},this._strokeStyle),t._stateStack=this._stateStack.slice(),t._bounds=this._bounds.clone(),t._boundsDirty=!0,t}get fillStyle(){return this._fillStyle}set fillStyle(t){this._fillStyle=ot(t,W.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(t){this._strokeStyle=Ot(t,W.defaultStrokeStyle)}setFillStyle(t){return this._fillStyle=ot(t,W.defaultFillStyle),this}setStrokeStyle(t){return this._strokeStyle=ot(t,W.defaultStrokeStyle),this}texture(t,s,e,i,r,n){return this.instructions.push({action:"texture",data:{image:t,dx:e||0,dy:i||0,dw:r||t.frame.width,dh:n||t.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:s||s===0?E.shared.setValue(s).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new H,this}fill(t,s){let e,i=this.instructions[this.instructions.length-1];return this._tick===0&&i?.action==="stroke"?e=i.data.path:e=this._activePath.clone(),e?(t!=null&&(s!==void 0&&typeof t=="number"&&(j(ie,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),t={color:t,alpha:s}),this._fillStyle=ot(t,W.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:e}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){let{x:t,y:s}=this._activePath.getLastPoint(N.shared);this._activePath.clear(),this._activePath.moveTo(t,s)}stroke(t){let s,e=this.instructions[this.instructions.length-1];return this._tick===0&&e?.action==="fill"?s=e.data.path:s=this._activePath.clone(),s?(t!=null&&(this._strokeStyle=Ot(t,W.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:s}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let t=0;t<2;t++){let s=this.instructions[this.instructions.length-1-t],e=this._activePath.clone();if(s&&(s.action==="stroke"||s.action==="fill"))if(s.data.hole)s.data.hole.addPath(e);else{s.data.hole=e;break}}return this._initNextPathLocation(),this}arc(t,s,e,i,r,n){this._tick++;let a=this._transform;return this._activePath.arc(a.a*t+a.c*s+a.tx,a.b*t+a.d*s+a.ty,e,i,r,n),this}arcTo(t,s,e,i,r){this._tick++;let n=this._transform;return this._activePath.arcTo(n.a*t+n.c*s+n.tx,n.b*t+n.d*s+n.ty,n.a*e+n.c*i+n.tx,n.b*e+n.d*i+n.ty,r),this}arcToSvg(t,s,e,i,r,n,a){this._tick++;let h=this._transform;return this._activePath.arcToSvg(t,s,e,i,r,h.a*n+h.c*a+h.tx,h.b*n+h.d*a+h.ty),this}bezierCurveTo(t,s,e,i,r,n,a){this._tick++;let h=this._transform;return this._activePath.bezierCurveTo(h.a*t+h.c*s+h.tx,h.b*t+h.d*s+h.ty,h.a*e+h.c*i+h.tx,h.b*e+h.d*i+h.ty,h.a*r+h.c*n+h.tx,h.b*r+h.d*n+h.ty,a),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(t,s,e,i){return this._tick++,this._activePath.ellipse(t,s,e,i,this._transform.clone()),this}circle(t,s,e){return this._tick++,this._activePath.circle(t,s,e,this._transform.clone()),this}path(t){return this._tick++,this._activePath.addPath(t,this._transform.clone()),this}lineTo(t,s){this._tick++;let e=this._transform;return this._activePath.lineTo(e.a*t+e.c*s+e.tx,e.b*t+e.d*s+e.ty),this}moveTo(t,s){this._tick++;let e=this._transform,i=this._activePath.instructions,r=e.a*t+e.c*s+e.tx,n=e.b*t+e.d*s+e.ty;return i.length===1&&i[0].action==="moveTo"?(i[0].data[0]=r,i[0].data[1]=n,this):(this._activePath.moveTo(r,n),this)}quadraticCurveTo(t,s,e,i,r){this._tick++;let n=this._transform;return this._activePath.quadraticCurveTo(n.a*t+n.c*s+n.tx,n.b*t+n.d*s+n.ty,n.a*e+n.c*i+n.tx,n.b*e+n.d*i+n.ty,r),this}rect(t,s,e,i){return this._tick++,this._activePath.rect(t,s,e,i,this._transform.clone()),this}roundRect(t,s,e,i,r){return this._tick++,this._activePath.roundRect(t,s,e,i,r,this._transform.clone()),this}poly(t,s){return this._tick++,this._activePath.poly(t,s,this._transform.clone()),this}regularPoly(t,s,e,i,r=0,n){return this._tick++,this._activePath.regularPoly(t,s,e,i,r,n),this}roundPoly(t,s,e,i,r,n){return this._tick++,this._activePath.roundPoly(t,s,e,i,r,n),this}roundShape(t,s,e,i){return this._tick++,this._activePath.roundShape(t,s,e,i),this}filletRect(t,s,e,i,r){return this._tick++,this._activePath.filletRect(t,s,e,i,r),this}chamferRect(t,s,e,i,r,n){return this._tick++,this._activePath.chamferRect(t,s,e,i,r,n),this}star(t,s,e,i,r=0,n=0){return this._tick++,this._activePath.star(t,s,e,i,r,n,this._transform.clone()),this}svg(t){return this._tick++,Oe(t,this),this}restore(){let t=this._stateStack.pop();return t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:G({},this._fillStyle),strokeStyle:G({},this._strokeStyle)}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,s=t){return this._transform.scale(t,s),this}setTransform(t,s,e,i,r,n){return t instanceof z?(this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty),this):(this._transform.set(t,s,e,i,r,n),this)}transform(t,s,e,i,r,n){return t instanceof z?(this._transform.append(t),this):(ss.set(t,s,e,i,r,n),this._transform.append(ss),this)}translate(t,s=t){return this._transform.translate(t,s),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this._boundsDirty=!0,!this.dirty&&(this.emit("update",this,16),this.dirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;this._boundsDirty=!1;let t=this._bounds;t.clear();for(let s=0;s<this.instructions.length;s++){let e=this.instructions[s],i=e.action;if(i==="fill"){let r=e.data;t.addBounds(r.path.bounds)}else if(i==="texture"){let r=e.data;t.addFrame(r.dx,r.dy,r.dx+r.dw,r.dy+r.dh,r.transform)}if(i==="stroke"){let r=e.data,n=r.style.alignment,a=r.style.width*(1-n),h=r.path.bounds;t.addFrame(h.minX-a,h.minY-a,h.maxX+a,h.maxY+a)}}return t}containsPoint(t){if(!this.bounds.containsPoint(t.x,t.y))return!1;let s=this.instructions,e=!1;for(let i=0;i<s.length;i++){let r=s[i],n=r.data,a=n.path;if(!r.action||!a)continue;let h=n.style,l=a.shapePath.shapePrimitives;for(let c=0;c<l.length;c++){let u=l[c].shape;if(!h||!u)continue;let f=l[c].transform,d=f?f.applyInverse(t,Ns):t;if(r.action==="fill")e=u.contains(d.x,d.y);else{let y=h;e=u.strokeContains(d.x,d.y,y.width,y.alignment)}let p=n.hole;if(p){let y=p.shapePath?.shapePrimitives;if(y)for(let g=0;g<y.length;g++)y[g].shape.contains(d.x,d.y)&&(e=!1)}if(e)return!0}}return e}unload(){this.emit("unload",this);for(let t in this._gpuData)this._gpuData[t]?.destroy();this._gpuData=Object.create(null)}destroy(t=!1){if(this.destroyed)return;if(this.destroyed=!0,this._stateStack.length=0,this._transform=null,this.unload(),this.emit("destroy",this),this.removeAllListeners(),typeof t=="boolean"?t:t?.texture){let e=typeof t=="boolean"?t:t?.textureSource;this._fillStyle.texture&&(this._fillStyle.fill&&"uid"in this._fillStyle.fill?this._fillStyle.fill.destroy():this._fillStyle.texture.destroy(e)),this._strokeStyle.texture&&(this._strokeStyle.fill&&"uid"in this._strokeStyle.fill?this._strokeStyle.fill.destroy():this._strokeStyle.texture.destroy(e))}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};Kt.defaultFillStyle={color:16777215,alpha:1,texture:V.WHITE,matrix:null,fill:null,textureSpace:"local"};Kt.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:V.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};var Dn=Kt;export{ge as a,Y as b,kt as c,ft as d,Ie as e,wt as f,Ct as g,ot as h,Ot as i,Dn as j};
