import{a as N}from"./chunk-PKO5ZNGR.js";import{a as M}from"./chunk-FDDRA6DH.js";import{a as E}from"./chunk-CTRNHETA.js";import{A as x,B as h,C as r,D as o,E as b,K as C,M as _,O as l,S as F,T as f,U as d,W as y,X as D,Z as I,_ as S,aa as L,ba as Y,g as u,ga as T,h as m,o as p,r as w,s as g,u as s,x as v,y as k}from"./chunk-NSEKHPH4.js";import"./chunk-C6Q5SG76.js";function Z(a,n){if(a&1){let t=C();r(0,"div",15),_("mousedown",function(i){u(t);let c=l();return m(c.startDrag(i))})("touchstart",function(i){u(t);let c=l();return m(c.startDrag(i))})("mousemove",function(i){u(t);let c=l();return m(c.drag(i))},g)("touchmove",function(i){u(t);let c=l();return m(c.drag(i))},g)("mouseup",function(){u(t);let i=l();return m(i.endDrag())},g)("touchend",function(){u(t);let i=l();return m(i.endDrag())},g),r(1,"div",16)(2,"p",17),d(3),o()()()}if(a&2){let t,e=l();F("transform",e.getCardTransform()),f("transition-all",!e.isDragging)("duration-300",!e.isDragging),s(3),y(' "',(t=e.currentCard())==null?null:t.text,'" ')}}function P(a,n){if(a&1&&(r(0,"div",18),d(1),o()),a&2){let t=l();h("ngClass",t.getFeedbackClass()),s(),y(" ",t.feedback()," ")}}function V(a,n){if(a&1){let t=C();r(0,"app-level-completion",19),_("onContinue",function(){u(t);let i=l();return m(i.continueToNextLevel())}),o()}}var X=class a{constructor(n,t,e){this.router=n;this.gameState=t;this.assetLoader=e}cards=[{id:1,text:"You're actually really smart.",category:"Red Flag"},{id:2,text:"I love how passionate you are.",category:"Friendly"},{id:3,text:"Your eyes distract me from working.",category:"Flirty"},{id:4,text:"Why are you wearing that?",category:"Red Flag"},{id:5,text:"Thanks for always being there.",category:"Friendly"},{id:6,text:"Is it hot in here or is it just you?",category:"Flirty"},{id:7,text:"You're too sensitive.",category:"Red Flag"},{id:8,text:"We make a great team.",category:"Friendly"}];totalCards=this.cards.length;currentIndex=0;currentCard=p(null);feedback=p("");sortedCount=p(0);isLevelComplete=p(!1);isDragging=!1;isProcessing=!1;startX=0;startY=0;currentX=0;currentY=0;hoverZone=null;companionImage=I(()=>{let n=this.gameState.companion(),t=this.gameState.mood(),e="idle";switch(t){case"Soft":e="idle";break;case"Boss":e="victorious";break;case"Mischief":e="happy";break;case"Overthink":e="thinking";break;default:e="idle"}return this.assetLoader.getCharacterImage(n,e)});ngOnInit(){this.gameState.currentLevel.set(3),this.loadNextCard()}loadNextCard(){this.currentIndex<this.cards.length?(this.isProcessing=!0,this.currentCard.set(null),this.currentX=0,this.currentY=0,this.hoverZone=null,setTimeout(()=>{this.isProcessing=!1,this.currentCard.set(this.cards[this.currentIndex])},300)):(this.currentCard.set(null),this.handleWin())}startDrag(n){this.isProcessing||this.isLevelComplete()||(this.isDragging=!0,n instanceof MouseEvent?(this.startX=n.clientX-this.currentX,this.startY=n.clientY-this.currentY):(this.startX=n.touches[0].clientX-this.currentX,this.startY=n.touches[0].clientY-this.currentY))}drag(n){if(!this.isDragging)return;n.preventDefault();let t,e;n instanceof MouseEvent?(t=n.clientX,e=n.clientY):(t=n.touches[0].clientX,e=n.touches[0].clientY),this.currentX=t-this.startX,this.currentY=e-this.startY,this.checkDropZone(t,e)}endDrag(){this.isDragging&&(this.isDragging=!1,this.hoverZone?this.attemptSort(this.hoverZone):(this.currentX=0,this.currentY=0,this.hoverZone=null))}getCardTransform(){let n=this.currentX*.1;return`translate(${this.currentX}px, ${this.currentY}px) rotate(${n}deg)`}checkDropZone(n,t){let e=window.innerHeight,i=window.innerWidth;if(t<e*.6){this.hoverZone=null;return}n<i/3?this.hoverZone="Friendly":n<i/3*2?this.hoverZone="Flirty":this.hoverZone="Red Flag"}attemptSort(n){let t=this.currentCard();if(t)if(t.category===n){this.isProcessing=!0,this.feedback.set(`Correct! ${n}`),this.currentIndex++,this.sortedCount.update(c=>c+1);let e=500,i=this.currentX;this.currentY=e,setTimeout(()=>{this.feedback.set(""),this.loadNextCard()},600)}else this.gameState.decreaseLife(),this.feedback.set(`Wrong! Not ${n}`),this.hoverZone=null,setTimeout(()=>{this.feedback.set(""),this.currentX=0,this.currentY=0},800)}sort(n){let t=this.currentCard();!t||this.isLevelComplete()||(t.category===n?(this.feedback.set(`Correct! ${n}`),this.currentIndex++,this.sortedCount.update(e=>e+1),setTimeout(()=>{this.feedback.set(""),this.loadNextCard()},800)):(this.feedback.set(`Wrong! Not ${n}`),setTimeout(()=>this.feedback.set(""),1e3)))}getFeedbackClass(){return this.feedback().startsWith("Correct")?"bg-green-500 text-white":"bg-red-500 text-white"}showCompletion=p(!1);handleWin(){this.isLevelComplete.set(!0),this.gameState.addToInventory("Boundary Compass"),setTimeout(()=>{this.showCompletion.set(!0)},1500)}continueToNextLevel(){this.router.navigate(["/valentine/bouquet-vault"])}static \u0275fac=function(t){return new(t||a)(v(T),v(E),v(M))};static \u0275cmp=k({type:a,selectors:[["app-level-3"]],decls:26,vars:18,consts:[[1,"fixed","inset-0","overflow-hidden","bg-slate-900","flex","flex-col","items-center","justify-center"],[1,"absolute","inset-0","z-0","bg-cover","bg-center",2,"background-image","url('/assets/bg_detector.jpg')"],[1,"relative","z-20","w-80","h-56","perspective-1000","mb-20","flex","justify-center","items-center"],["class","absolute w-64 h-40 bg-white rounded-xl shadow-2xl p-4 flex items-center justify-center text-center border-2 border-gray-100 cursor-grab active:cursor-grabbing touch-none select-none transition-transform",3,"transform","transition-all","duration-300","mousedown","touchstart","mousemove","touchmove","mouseup","touchend",4,"ngIf"],[1,"absolute","top-24","right-4","z-20","bg-white/10","backdrop-blur-md","px-4","py-2","rounded-full","border","border-white/20","text-white","font-mono","text-xl","font-bold","shadow-lg","pointer-events-none"],[1,"absolute","bottom-0","right-4","md:right-10","z-10","w-40","md:w-60","pointer-events-none","filter","drop-shadow-2xl"],["alt","Companion",1,"w-full","object-contain",3,"src"],["class","absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-50 px-8 py-4 rounded-2xl shadow-2xl text-2xl font-bold animate-bounce transition-all duration-300 pointer-events-none",3,"ngClass",4,"ngIf"],[1,"absolute","bottom-20","left-0","right-0","z-10","flex","h-24","md:h-32","items-end","pointer-events-none","w-full","px-2","gap-1"],[1,"flex-1","h-full","flex","flex-col","items-center","justify-end","pb-4","border-t-4","border-green-400","transition-colors","duration-300","bg-green-900/40","backdrop-blur-sm","rounded-t-xl"],[1,"text-2xl","mb-1","filter","drop-shadow-md"],[1,"text-white","font-bold","tracking-widest","uppercase","drop-shadow-md","text-sm","md:text-base"],[1,"flex-1","h-full","flex","flex-col","items-center","justify-end","pb-4","border-t-4","border-pink-400","transition-colors","duration-300","bg-pink-900/40","backdrop-blur-sm","rounded-t-xl"],[1,"flex-1","h-full","flex","flex-col","items-center","justify-end","pb-4","border-t-4","border-red-400","transition-colors","duration-300","bg-red-900/40","backdrop-blur-sm","rounded-t-xl"],["itemName","Boundary Compass","itemImage","assets/icon_compass.png","itemDescription","You navigated the signals perfectly. Your compass is true!",3,"onContinue",4,"ngIf"],[1,"absolute","w-64","h-40","bg-white","rounded-xl","shadow-2xl","p-4","flex","items-center","justify-center","text-center","border-2","border-gray-100","cursor-grab","active:cursor-grabbing","touch-none","select-none","transition-transform",3,"mousedown","touchstart","mousemove","touchmove","mouseup","touchend"],[1,"pointer-events-none"],[1,"text-lg","font-bold","text-gray-800","leading-snug"],[1,"absolute","top-1/2","left-1/2","transform","-translate-x-1/2","-translate-y-1/2","z-50","px-8","py-4","rounded-2xl","shadow-2xl","text-2xl","font-bold","animate-bounce","transition-all","duration-300","pointer-events-none",3,"ngClass"],["itemName","Boundary Compass","itemImage","assets/icon_compass.png","itemDescription","You navigated the signals perfectly. Your compass is true!",3,"onContinue"]],template:function(t,e){t&1&&(r(0,"div",0),b(1,"div",1),r(2,"div",2),x(3,Z,4,7,"div",3),o(),r(4,"div",4),d(5),o(),r(6,"div",5),b(7,"img",6),o(),x(8,P,2,2,"div",7),r(9,"div",8)(10,"div",9)(11,"span",10),d(12,"\u{1F33F}"),o(),r(13,"span",11),d(14,"Friendly"),o()(),r(15,"div",12)(16,"span",10),d(17,"\u{1F48B}"),o(),r(18,"span",11),d(19,"Flirty"),o()(),r(20,"div",13)(21,"span",10),d(22,"\u{1F6A9}"),o(),r(23,"span",11),d(24,"Red Flag"),o()()(),x(25,V,1,0,"app-level-completion",14),o()),t&2&&(s(3),h("ngIf",e.currentCard()&&!e.isProcessing),s(2),D(" ",e.currentIndex," / ",e.totalCards," "),s(2),h("src",e.companionImage(),w),s(),h("ngIf",e.feedback()),s(2),f("bg-green-600/60",e.hoverZone==="Friendly")("bg-opacity-60",e.hoverZone==="Friendly"),s(5),f("bg-pink-600/60",e.hoverZone==="Flirty")("bg-opacity-60",e.hoverZone==="Flirty"),s(5),f("bg-red-600/60",e.hoverZone==="Red Flag")("bg-opacity-60",e.hoverZone==="Red Flag"),s(5),h("ngIf",e.showCompletion()))},dependencies:[Y,S,L,N],styles:["[_nghost-%COMP%]{display:block;touch-action:none}.perspective-1000[_ngcontent-%COMP%]{perspective:1000px}.animate-pop-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_popIn .4s cubic-bezier(.175,.885,.32,1.275)}@keyframes _ngcontent-%COMP%_popIn{0%{transform:translate(-50%,-50%) scale(.5);opacity:0}to{transform:translate(-50%,-50%) scale(1);opacity:1}}"]})};export{X as Level3Component};
